<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Monitoramento RD - Farm√°cias Isoladas</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f9; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; }
        .container { max-width: 500px; width: 90%; background: white; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.1); overflow: hidden; border-top: 6px solid #003366; }
        .header { background-color: #003366; color: white; padding: 20px; text-align: center; }
        .content { padding: 25px; text-align: center; }
        label { display: block; text-align: left; font-weight: bold; margin-bottom: 5px; color: #333; }
        input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 6px; margin-bottom: 15px; box-sizing: border-box; font-size: 16px; }
        .btn-search { width: 100%; padding: 12px; border: none; border-radius: 6px; background-color: #003366; color: white; font-weight: bold; cursor: pointer; }
        .btn-email { width: 100%; padding: 12px; border: none; border-radius: 6px; background-color: #28a745; color: white; font-weight: bold; cursor: pointer; margin-top: 15px; display: none; }
        .result-box { margin-top: 20px; padding: 15px; background: #f9f9f9; border-left: 4px solid #003366; text-align: left; display: none; font-size: 14px; line-height: 1.6; }
        .status-msg { margin-top: 10px; font-size: 13px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h2>üì° Farm√°cias Isoladas</h2></div>
    <div class="content">
        <label>C√≥digo JAVA da Filial:</label>
        <input type="text" id="javaInput" placeholder="Ex: 7" onkeypress="if(event.key === 'Enter') buscarLojaLocal()">
        <button class="btn-search" onclick="buscarLojaLocal()">üîç Consultar Base de Dados</button>
        
        <div id="statusMsg" class="status-msg"></div>

        <div id="resultBox" class="result-box">
            <strong>üìç Filial:</strong> <span id="resFilial"></span><br>
            <strong>üè¢ Regional:</strong> <span id="resRegional"></span><br>
            <strong>üìß E-mail Loja:</strong> <span id="resEmail"></span>
        </div>
        
        <button id="btnGerarEmail" class="btn-email" onclick="dispararEmail()">üìß Abrir E-mail no Outlook</button>
    </div>
</div>

<script>
    // BASE DE DADOS LOCAL (Aqui voc√™ insere os dados da sua planilha da imagem image_d24ce7.png)
    const baseLojas = [
        { java: "6", nome: "SP PAULISTA", regional: "CARLA GABRIELA", emailReg: "carlborges@rd.com.br", emailLoja: "LJ0006@rd.com.br" },
        { java: "7", nome: "SAO CARLOS", regional: "JORGE LUIZ", emailReg: "jlbueno@rd.com.br", emailLoja: "LJ0007@rd.com.br" },
        { java: "8", nome: "ARARAQUARA", regional: "JORGE LUIZ", emailReg: "jlbueno@rd.com.br", emailLoja: "LJ0008@rd.com.br" },
        { java: "4517", nome: "ANDARAI C", regional: "ROBERTO SILVA", emailReg: "roberto@rd.com.br", emailLoja: "LJ1603@rd.com.br" },
        { java: "5062", nome: "Indaiatuba G", regional: "MARCOS SOUZA", emailReg: "marcos@rd.com.br", emailLoja: "LJ5062@rd.com.br" }
        // Voc√™ pode adicionar mais linhas seguindo este padr√£o
    ];

    let lojaSelecionada = null;

    function buscarLojaLocal() {
        const javaInput = document.getElementById('javaInput').value.trim();
        const status = document.getElementById('statusMsg');
        
        // Busca instant√¢nea na lista acima (sem depend√™ncia de internet)
        lojaSelecionada = baseLojas.find(l => l.java === javaInput);

        if (lojaSelecionada) {
            document.getElementById('resFilial').innerText = `${lojaSelecionada.java} - ${lojaSelecionada.nome}`;
            document.getElementById('resRegional').innerText = lojaSelecionada.regional;
            document.getElementById('resEmail').innerText = lojaSelecionada.emailLoja;

            status.innerHTML = "‚úÖ Dados carregados com sucesso!";
            status.style.color = "green";
            document.getElementById('resultBox').style.display = "block";
            document.getElementById('btnGerarEmail').style.display = "block";
        } else {
            status.innerHTML = "‚ö†Ô∏è C√≥digo JAVA n√£o encontrado na base local.";
            status.style.color = "orange";
            document.getElementById('resultBox').style.display = "none";
            document.getElementById('btnGerarEmail').style.display = "none";
        }
    }

    function dispararEmail() {
        if (!lojaSelecionada) return;
        
        const suporteMonitoramento = "suportemonitoramento@rd.com.br";
        const destinatario = lojaSelecionada.emailLoja;
        const cc = `${lojaSelecionada.emailReg}; ${suporteMonitoramento}`;
        
        const assunto = encodeURIComponent(`Desligamento de Servi√ßos - Filial ${lojaSelecionada.java} ‚Äì ${lojaSelecionada.nome}`);
        
        const corpo = encodeURIComponent(`Prezados, boa tarde!\n\nEncaminhamos este e-mail para informar que os servi√ßos da Filial ${lojaSelecionada.java} ‚Äì ${lojaSelecionada.nome} foram desligados devido √† identifica√ß√£o de um erro sist√™mico em nosso radar (farm√°cias isoladas), bem como √† aus√™ncia de registros de atendimentos no TC/TR na √∫ltima hora.\n\nSolicitamos, por gentileza, que ap√≥s a normaliza√ß√£o do cen√°rio, para a reativa√ß√£o dos servi√ßos, entrem em contato com o Suporte √† Loja por meio do chat.\n\nEm caso de d√∫vidas, permanecemos √† disposi√ß√£o pelos canais de Suporte √† Loja, dispon√≠veis 24 horas por dia, todos os dias da semana, por meio do link abaixo:\n\nhttps://grupordprod.service-now.com/esc\n\nAtenciosamente,`);

        window.location.href = `mailto:${destinatario}?cc=${cc}&subject=${assunto}&body=${corpo}`;
    }
</script>
</body>
</html>
